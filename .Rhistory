add_header_above(c(" " = 9,"Factor loadings"=8)) %>%
column_spec(column = c(1),width ="7in",include_thead = T) %>%
column_spec(column = c(2:17),width ="0.5in",include_thead = T) %>%
kable_styling(full_width = FALSE) %>%
kable_styling(full_width = F)
# Chunk 16
stargazer(dat03,type = "html",
title = "Descriptive statistics",
font.size = "small",
median = TRUE,
header=FALSE,
digit.separator = "",
digits = 2,
covariate.labels = c("A. pc.effort", "B. pc.talent","C. pc.wpart","D. pc.netw","E. pf.effort","F. pf.talent","G. pf.wpart", "H. pf.netw"))
# Chunk 17
cor03<-polychoric(dat03)
rownames(cor03$rho) <-c("A. pc.effort", "B. pc.talent","C. pc.wpart","D. pc.netw","E. pf.effort","F. pf.talent","G. pf.wpart", "H. pf.netw")
colnames(cor03$rho) <-c("(A)","(B)","(C)","(D)","(E)","(F)","(G)", "(H)")
corrplot(cor03$rho,method = "color", type = "upper", tl.col = "black", addCoef.col = "black",diag = FALSE)
# Chunk 18
model03 <- '
perc_merit=~perc_effort+perc_talent
perc_nmerit=~perc_wpart+perc_netw
pref_merit=~pref_effort+pref_talent
pref_nmerit=~pref_wpart+pref_netw'
fit3_c <- cfa(model = model03,data = dat03,estimator="MLR",std.lv=FALSE) # Continuous/ estimator ML Robust
fit3_o <- cfa(model = model03,data = dat03,ordered = c("perc_effort","perc_talent",
"perc_wpart","perc_netw",
"pref_effort","pref_talent",
"pref_wpart","pref_netw"),std.lv=FALSE)
#---------------------------------------------------#
cnames <- c("Factor","Indicator","Loading (MLR)","Loading (DWLS)")
kable(left_join(x = standardizedsolution(fit3_c) %>% filter(op=="=~") %>% select(lhs,rhs,est.std),y = standardizedsolution(fit3_o) %>% filter(op=="=~") %>% select(lhs,rhs,est.std),c("lhs","rhs")),
format = "markdown",digits = 2,col.names = cnames, caption = "Factor loadings")
# Chunk 19
polyw03<- poly(sjlabelled::remove_all_labels(dat03),
digits = 2,
triangle = "l",
fade.ns = F,
remove.spaces = T,
string.diag = c("$-$","$-$","$-$","$-$","$-$","$-$","$-$","$-$"))
matpolyw03 <- as.data.frame(read_html(x = polyw03[["page.content"]]) %>% html_table(fill=FALSE))
matpolyw03 <- matpolyw03[-c(9),]
colnames(matpolyw03) <- c("vars","(A)","(B)","(C)","(D)","(E)","(F)","(G)", "(H)")
load03<- data.frame(round(cbind(inspect(fit3_c,what="std")$lambda,inspect(fit3_o,what="std")$lambda),digits = 2))
load03[load03==c(0.00)] <- NA; names(load03) <- c(1:4,1:4)
table03<- bind_cols(x = matpolyw03,y = load03)
# %>% mutate(vars=labs)
kable(table03,escape = FALSE,align = "l",col.names = cnametab) %>%
footnote(general = paste0(paste0("$N$= ",nobs(fit3_c)),"; p<0.05=$*$; p<0.01=$**$; p<0.001=$***$"),footnote_as_chunk = T) %>%
add_header_above(c(" " = 1,"Polychoric correlations"=8, "MLR" = 4, "DWLS" = 4))%>%
add_header_above(c(" " = 9,"Factor loadings"=8)) %>%
column_spec(column = c(1),width ="7in",include_thead = T) %>%
column_spec(column = c(2:17),width ="0.5in",include_thead = T) %>%
kable_styling(full_width = F)
# Chunk 20
model03.tau <- '
perc_merit=~ r1*perc_effort+r1*perc_talent
perc_nmerit=~r2*perc_wpart+ r2*perc_netw
pref_merit=~ r3*pref_effort+r3*pref_talent
pref_nmerit=~r4*pref_wpart+ r4*pref_netw'
fit3_c.tau <- cfa(model = model03.tau,data = dat03,estimator="MLR",std.lv=FALSE) # Continuous/ estimator ML Robust
fit3_o.tau <- cfa(model = model03.tau,data = dat03,ordered = c("perc_effort","perc_talent",
"perc_wpart","perc_netw",
"pref_effort","pref_talent",
"pref_wpart","pref_netw"), std.lv=FALSE)
#---------------------------------------------------#
cnames <- c("Factor","Indicator","Loading (MLR)","Loading (DWLS)")
kable(left_join(x = standardizedsolution(fit3_c.tau ) %>% filter(op=="=~") %>% select(lhs,rhs,est.std),y = standardizedsolution(fit3_o.tau) %>% filter(op=="=~") %>% select(lhs,rhs,est.std),c("lhs","rhs")),
format = "markdown",digits = 2,col.names = cnames)
# Chunk 21
kable(rbind(Ordinal    =fitmeasures(fit3_o    )[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")],
Ordinal.tau=fitmeasures(fit3_o.tau)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")]),
format = "markdown",
digits = 3, caption = "Fit tau-equivalence")
kable(anova(fit3_o,fit3_o.tau),
format = "markdown",
digits = 3)
# Chunk 22: tabla03
polyw03tau<- poly(sjlabelled::remove_all_labels(dat03),
digits = 2,
triangle = "l",
fade.ns = F,
remove.spaces = T,
string.diag = c("$-$","$-$","$-$","$-$","$-$","$-$","$-$","$-$"))
matpolyw03tau <- as.data.frame(read_html(x = polyw03tau[["page.content"]]) %>% html_table(fill=FALSE))
matpolyw03tau <- matpolyw03tau[-c(9),]
colnames(matpolyw03tau) <- c("vars","(A)","(B)","(C)","(D)","(E)","(F)","(G)", "(H)")
load03tau<- data.frame(round(cbind(inspect(fit3_c.tau,what="std")$lambda,inspect(fit3_o.tau,what="std")$lambda),digits = 2))
load03tau[load03tau==c(0.00)] <- NA; names(load03tau) <- c(1:4,1:4)
table03tau<- bind_cols(x = matpolyw03tau,y = load03tau)
# %>% mutate(vars=labs)
kable(table03tau,escape = FALSE,align = "l",col.names = cnametab) %>%
footnote(general = paste0(paste0("$N$= ",nobs(fit3_c.tau)),"; p<0.05=$*$; p<0.01=$**$; p<0.001=$***$"),footnote_as_chunk = T) %>%
add_header_above(c(" " = 1,"Polychoric correlations"=8, "MLR" = 4, "DWLS" = 4))%>%
add_header_above(c(" " = 9,"Factor loadings"=8)) %>%
column_spec(column = c(1),width ="7in",include_thead = T) %>%
column_spec(column = c(2:17),width ="0.5in",include_thead = T) %>%
kable_styling(full_width = F)
# Chunk 23
stargazer(select(dat04,perc_effort,perc_talent,perc_wpart,perc_netw,pref_effort,pref_talent,pref_wpart,pref_netw),
type = "html",
title = "Descriptive statistics",
font.size = "small",
median = TRUE,
header=FALSE,
digit.separator = "",
digits = 2,
covariate.labels = c("A. pc.effort", "B. pc.talent","C. pc.wpart","D. pc.netw","E. pf.effort","F. pf.talent","G. pf.wpart", "H. pf.netw"))
# Chunk 24
cor04<-polychoric(select(dat04,perc_effort,perc_talent,perc_wpart,perc_netw,pref_effort,pref_talent,pref_wpart,pref_netw))
rownames(cor04$rho) <-c("A.Perception Effort", "B.Perception Talent","C.Perception Rich parents","D.Perception contacts","E.Preferences Effort","F.Preferences Talent","G.Preferences rich parents", "H.Preferences contacts" )
colnames(cor04$rho) <-c("(A)", "(B)","(C)","(D)","(E)","(F)","(G)", "(H)")
save(cor04, file = "output/images/correlation.RData")
corrplot(cor04$rho,method = "color", type = "upper", tl.col = "black", addCoef.col = "black",diag = FALSE)
png("output/images/corpoly.png",
width = 15,height = 15,units="cm",
pointsize=12,bg="white",res=300)
corrplot(cor01$rho,method = "color" ,type = "upper", tl.col = "black", addCoef.col = "black",diag = FALSE)
dev.off()
# Chunk 25
model04 <- '
perc_merit =~ perc_effort+perc_talent
perc_nmerit=~perc_wpart +perc_netw
pref_merit =~ pref_effort+pref_talent
pref_nmerit=~pref_wpart +pref_netw'
fit4_c <- cfa(model = model04,data = dat04,estimator="MLR",std.lv=FALSE) # Continuous/ estimator ML Robust
fit4_o <- cfa(model = model04,data = dat04,ordered = c("perc_effort","perc_talent",
"perc_wpart","perc_netw",
"pref_effort","pref_talent",
"pref_wpart","pref_netw"),std.lv=FALSE)
#---------------------------------------------------#
cnames <- c("Factor","Indicator","Loading (MLR)","Loading (DWLS)")
kable(left_join(x = standardizedsolution(fit4_c ) %>% filter(op=="=~") %>% select(lhs,rhs,est.std),y = standardizedsolution(fit4_o) %>% filter(op=="=~") %>% select(lhs,rhs,est.std),c("lhs","rhs")),
format = "markdown",digits = 2,col.names = cnames, caption = "Factor loadings")
# Chunk 26: tabla04
polyw04<- poly(sjlabelled::remove_all_labels(dat04[,-c(1)]),
digits = 2,
triangle = "l",
fade.ns = F,
remove.spaces = T,
string.diag = c("$-$","$-$","$-$","$-$","$-$","$-$","$-$","$-$"))
matpolyw04 <- as.data.frame(read_html(x = polyw04[["page.content"]]) %>% html_table(fill=FALSE))
matpolyw04 <- matpolyw04[-c(9),]
colnames(matpolyw04) <- c("vars","(A)","(B)","(C)","(D)","(E)","(F)","(G)", "(H)")
load04<- data.frame(round(cbind(inspect(fit4_c,what="std")$lambda,inspect(fit4_o,what="std")$lambda),digits = 2))
load04[load04==c(0.00)] <- NA; names(load04) <- c(1:4,1:4)
table04<- bind_cols(x = matpolyw04,y = load04)
# %>% mutate(vars=labs)
kable(table04,escape = FALSE,align = "l",col.names = cnametab) %>%
footnote(general = paste0(paste0("$N$= ",nobs(fit4_c)),"; p<0.05=$*$; p<0.01=$**$; p<0.001=$***$"),footnote_as_chunk = T) %>%
add_header_above(c(" " = 1,"Polychoric correlations"=8, "MLR" = 4, "DWLS" = 4))%>%
add_header_above(c(" " = 9,"Factor loadings"=8)) %>%
column_spec(column = c(1),width ="7in",include_thead = T) %>%
column_spec(column = c(2:17),width ="0.5in",include_thead = T) %>%
kable_styling(full_width = F)
# Chunk 27: tb_desc-corr
load04<- data.frame(round(inspect(fit4_o,what="std")$lambda,digits = 2))
load04[load04==c(0.00)] <- NA; names(load04) <- c(1:4)
colnames(matpolyw04) <- c("Variable","A","B","C","D","E","F","G", "H")
sum04b  <- psych::describe(dat04[,-c(1)], fast = T) %>% select(mean,sd,min,max) %>% data.frame() %>% round(digits = 2)
table04b<- bind_cols(x = sum04b,y = matpolyw04) %>% select(Variable, everything()) %>% mutate(Variable=labs) %>% rename("Mean"=mean, "SD"=sd, "Min"=min,"Max"=max)
cap01 <- "Descriptive statistic"
sumdat04<- kable(table04b, escape = FALSE,align = "l",linesep = "", caption = cap01) %>%
column_spec(column = 1,width = "10cm",width_min = "12cm",include_thead = TRUE) %>%
footnote(general = paste0(paste0("$N$= ","2141"),"; p<0.05=$*$; p<0.01=$**$; p<0.001=$***$"),footnote_as_chunk = T) %>%
add_header_above(header = c(" "=5,"Polychoric correlations"= 8)) %>%
kable_styling(full_width = TRUE,font_size = 8,position = "center");sumdat04
save(sumdat04,file = "output/tables/sumdat04.RData")
# Chunk 28: tb_loads-fitm
tb.load<- data.frame(round(cbind(inspect(fit1_o,what="std")$lambda,
inspect(fit2_o,what="std")$lambda,
inspect(fit3_o,what="std")$lambda),
digits = 2))
tb.load[tb.load==c(0.00)] <- NA; names(tb.load) <- c(paste0("M1.",1:4),paste0("M2.",1:4),paste0("M3.",1:4))
for (i in names(tb.load)) {
# tb.load[,i] <- sjlabelled::as_character(tb.load[,i])
tb.load[,i] <- sprintf(tb.load[,i], fmt = '%#.2f')
}
tb.load[tb.load=="NA"] <- ""
#-------#
fm01<- data.frame(t(data.frame(fitmeasures(fit1_o, output ="matrix")[c("chisq.scaled","df","cfi.scaled","rmsea.scaled"),]))); row.names(fm01) ="M1.1"
fm02<- data.frame(t(data.frame(fitmeasures(fit2_o, output ="matrix")[c("chisq.scaled","df","cfi.scaled","rmsea.scaled"),]))); row.names(fm02) ="M2.1"
fm03<- data.frame(t(data.frame(fitmeasures(fit3_o, output ="matrix")[c("chisq.scaled","df","cfi.scaled","rmsea.scaled"),]))); row.names(fm03) ="M3.1"
#------chi2, df------#
fm04<- round(rbind(fm01,fm02,fm03),3)
fm04.1 <- fm04 %>% select(chisq.scaled,df)
fm04.1$chisq.scaled <- round(x = fm04.1$chisq.scaled,digits = 1)
fm04.1$df <- round(x = fm04.1$df,digits = 0)
fm04.1$chi2df <- paste0(fm04.1$chisq.scaled,"(",fm04.1$df,")")
fm04.1 <- select(fm04.1,"chi2df")
for (i in names(fm04.1)) {
fm04.1[,i] <- as.character(fm04.1[,i])
}
#------CFI, RMSEA------#
fm04.2 <- fm04 %>% select(cfi.scaled,rmsea.scaled)
for (i in names(fm04.2)) {
fm04.2[,i] <- sprintf(fm04.2[,i], fmt = '%#.3f')
}
fm.df      <- bind_cols(fm04.1,fm04.2)
fm.df$nobs <- c(nobs(fit1_o),nobs(fit2_o),nobs(fit3_o))
fm.df <- data.frame(t(fm.df)); colnames(fm.df) <- c("M1.2","M2.2","M3.2")
#------ merge ------#
tb.fm<- bind_rows(tb.load,fm.df)
tb.fm<- tb.fm %>% mutate(vars=c(labs,"$\\chi^2\\text{(df)}$","$\\text{CFI}$","$\\text{RMSEA}$","$N$")) %>% select(vars,everything())
#--table---#
tb.col  <- c("Variables",1:4,1:4,1:4)
tb.foot <- paste0("; p<0.05=$*$; p<0.01=$**$; p<0.001=$***$. Standardised factor loadings using DWLS estimator. CFI = Comparative fit index (scaled), RMSEA = Root mean square error of approximation (scaled)")
tb.caption <- "Factor loadings and fit measures"
tb.fm01<- kable(tb.fm,escape = FALSE,align = "lcccccccccccc",col.names = tb.col, caption = tb.caption) %>%
kable_styling(full_width = F,font_size = 9) %>%
column_spec(column = 1,width = "10cm",width_min = "12cm",include_thead = TRUE) %>%
column_spec(column = 2:13,width = "1cm",width_min = "1.3cm",include_thead = TRUE) %>%
add_header_above(header = c(" "=1,"Version 1"= 4,"Version 2"= 4,"Version 3"= 4)) %>%
add_header_above(header = c(" "=1,"Factor loadings"= 12)) %>%
row_spec(row = 8,hline_after = TRUE) %>%
add_indent(c(9:12)) %>%
footnote(general =tb.foot ,footnote_as_chunk = T);tb.fm01
save(tb.fm01,file = "output/tables/tb.fm01.RData")
save(tb.fm,file = "output/tables/tb.fm.RData")
save(fm.df,file = "output/tables/fm.df.RData")
save(tb.load,file = "output/tables/tb.load.RData")
# Chunk 29: compare corr
corrplot(cor01$rho,method = "color" ,type = "upper", tl.col = "black", addCoef.col = "black",diag = FALSE)
corrplot(cor02$rho,method = "color", type = "upper", tl.col = "black", addCoef.col = "black",diag = FALSE)
corrplot(cor03$rho,method = "color", type = "upper", tl.col = "black", addCoef.col = "black",diag = FALSE)
# Chunk 30: semPlot
model01 <- 'perc_merit=~perc_effort+perc_talent
perc_nmerit=~perc_wpart+perc_netw
pref_merit=~pref_effort+pref_talent
pref_nmerit=~pref_wpart+pref_netw'
plot01 <- cfa(model = model01,data = dat01,estimator="MLR",std.lv=TRUE)
nodeNames <-c("Perception effort","Perception talent","Perception rich family","Perception networks",
"Preference effort","Preference talent","Preference rich family","Preference networks",
"Perception meritocratic","Perception non meritocratic","Preference meritocratic","Preference non meritocratic")
dir.create("output/images")
semPaths(plot01,
style = "lisrel",
fade=FALSE,
edge.color = "black",
nCharNodes = 0,
curvePivot = FALSE,
curve = 2,
rotation = 4,
layout = "tree3",
cardinal = "lat cov",
legend.cex = 0.6,
label.cex =1,
reorder = FALSE,
nodeNames = nodeNames,
nodeLabels = c("A","B","C","D","E","F","G","H","1","2","3","4"),
label.font = 6,
edge.label.font= 1,
asize = 3, #arrow size
edge.width =1,
sizeMan=5,
sizeLat = 10,
filetype ="png",
width = 12,
height= 10,
filename = "output/images/meas01")
# Chunk 31
sum_fit<- bind_rows(fitmeasures(fit1_c)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")],
fitmeasures(fit1_o)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")],
fitmeasures(fit2_c)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")],
fitmeasures(fit2_o)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")],
fitmeasures(fit3_c)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")],
fitmeasures(fit3_o)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")],
fitmeasures(fit4_c)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")],
fitmeasures(fit4_o)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")])
sum_fit$mod <- c("Model 1","Model 1","Model 2","Model 2","Model 3","Model 3","Model 4","Model 4")
sum_fit$est <- c("MLR","DWLS","MLR","DWLS","MLR","DWLS","MLR","DWLS")
sum_fit <- select(sum_fit,mod,est,everything())
colnames <- c("Model","Estimator","$\\chi^2$","df","CFI","CFI.sca","CFI.rob","RMSEA","RMSEA.sca","RMSEA.rob")
sumtable01<- kable(sum_fit,digits = 3,format = "html",row.names = F,booktabs=T, caption = "Summary fit indices wave 01",col.names = colnames,escape = FALSE) %>%
kable_styling(full_width = F)  %>%
collapse_rows(columns = 1,valign = "middle")  %>%
footnote(number = c("Model 1: fixed order by percepction/preference",
"Model 2: fixed order by topic (i.e: effort)",
"Model 3: Randomized order",
"Model 4: Complete sample"));sumtable01
# Save sumamry table wave 01------------------------------#
# as_image(sumtable01,file = "output/sumtablew01.png")
# save_kable(sumtable01,file = "output/tables/sumtablew01.html",self_contained = FALSE)
# Chunk 32
model04 <- '
perc_merit =~ perc_effort + perc_talent
perc_nmerit=~ perc_wpart  + perc_netw
pref_merit =~ pref_effort + pref_talent
pref_nmerit=~ pref_wpart  + pref_netw'
fit4_c_mg <- cfa(model = model04,data = dat04,estimator="MLR",std.lv=FALSE,group = "grupo") # Continuous/ estimator ML Robust
fit4_o_mg <- cfa(model = model04,data = dat04,ordered = c("perc_effort","perc_talent",
"perc_wpart","perc_netw",
"pref_effort","pref_talent",
"pref_wpart","pref_netw"),std.lv=FALSE, group = "grupo")
#---------------------------------------------------#
kable(rbind(Continuous=fitmeasures(fit4_c_mg)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")],
Ordinal=  fitmeasures(fit4_o_mg)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")]),
format = "markdown",digits = 3,caption = "Fit indices")
gr01=standardizedsolution(fit4_c_mg) %>% filter(op=="=~") %>% select(group,lhs,rhs,est.std)
gr02=standardizedsolution(fit4_o_mg) %>% filter(op=="=~") %>% select(group,lhs,rhs,est.std)
gr01$group=dplyr::recode(gr01$group, `1` = "mod03", `2` = "mod02", `3` = "mod01")
gr02$group=dplyr::recode(gr02$group, `1` = "mod03", `2` = "mod02", `3` = "mod01")
cnames <- c("Grupo","Factor","Indicator","Loading (MLR)","Loading (DWLS)")
kable(left_join(x =gr01 ,
y =gr02 ,
c("group","lhs","rhs")),
format = "markdown",digits = 2,col.names = cnames,caption = "Factor loadings by group")
# Chunk 33
model04b1or <- '
perc_merit=~ perc_effort+perc_talent
perc_nmerit=~perc_wpart +perc_netw
pref_merit=~ pref_effort+pref_talent
pref_nmerit=~pref_wpart +pref_netw
percep=~ perc_merit + perc_nmerit
prefer=~ pref_merit + pref_nmerit'
fit4a_c <- cfa(model = model04b1or,data = dat04, estimator="MLR")
fit4b_c <- cfa(model = model04b1or,data = dat04,ordered = c("perc_effort","perc_talent","perc_wpart","perc_netw",
"pref_effort","pref_talent","pref_wpart","pref_netw"))
#---------------------------------------------------#
kable(rbind(Continuous=fitmeasures(fit4a_c)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")],
Ordinal= fitmeasures(fit4b_c)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")]),
format = "markdown",digits = 3)
cnames <- c("Factor","Indicator","Loading (MLR)","Loading (DWLS)")
kable(left_join(x = standardizedsolution(fit4a_c) %>% filter(op=="=~") %>% select(lhs,rhs,est.std),
y = standardizedsolution(fit4b_c) %>% filter(op=="=~") %>% select(lhs,rhs,est.std),
c("lhs","rhs")),
format = "markdown",digits = 2,col.names = cnames,caption = "Factor loadings")
# Chunk 34
model04b2or <-'perc_merit=~ perc_effort+perc_talent
perc_nmerit=~perc_wpart +perc_netw
pref_merit=~ pref_effort+pref_talent
pref_nmerit=~pref_wpart +pref_netw
merit =~ perc_merit  + pref_merit
nmerit=~ perc_nmerit + pref_nmerit'
# fit4b_c <- cfa(model = model04b2or,data = dat04,estimator="MLR") # No converge
fit4b_o <- cfa(model = model04b2or,data = dat04,
ordered = c("perc_effort","perc_talent","perc_wpart","perc_netw",
"pref_effort","pref_talent","pref_wpart","pref_netw"))
#---------------------------------------------------#
kable(rbind(Ordinal=fitmeasures(fit4b_o)[c("chisq.scaled","df","cfi","cfi.scaled","cfi.robust","rmsea","rmsea.scaled","rmsea.robust")]),
format = "markdown",digits = 3)
cnames <- c("Factor","Indicator","Loading (DWLS)")
kable(standardizedsolution(fit4b_o) %>% filter(op=="=~") %>% select(lhs,rhs,est.std),
format = "markdown",digits = 2,col.names = cnames,caption = "Factor loadings")
# Chunk 35
library(ggplot2)
library(reshape2)
library(sjPlot)
library(dplyr)
#install.packages("cowplot")
library(cowplot)
dat_merit <- dat04 %>% select("a.Effort"=perc_effort,"a.Talent"=perc_talent, "a.Rich Parents"=perc_wpart, "a.Contacts"=perc_netw, "b.Effort"=pref_effort,"b.Talent"=pref_talent,"b.Rich Parents"=pref_wpart, "b.Contacts"=pref_netw)
plotlikert<-plot_likert(dat_merit, c(1,1,1,1,2,2,2,2),
groups.titles = c("Perceptions","Preferences"),
geom.colors ="PuBu",
axis.labels=c("Effort","Talent","Rich Parents","Contacts"),
catcount = 4,
cat.neutral = 3,
grid.range  =  c ( 1.2 , 1.4 ),
values  =  "sum.outside",
reverse.scale=TRUE)
plotlikert
ggsave(plotlikert,filename = "output/images/plotlikert.png",device = "png",width = 20,height = 15,dpi = "retina",units = "cm")
rmarkdown::render_site("docs/paper.Rmd", output_format = "pdf_document")
library(ggplot2)
library(reshape2)
library(sjPlot)
library(dplyr)
#install.packages("cowplot")
library(cowplot)
dat_merit <- dat04 %>% select("a.Effort"=perc_effort,"a.Talent"=perc_talent, "a.Rich Parents"=perc_wpart, "a.Contacts"=perc_netw, "b.Effort"=pref_effort,"b.Talent"=pref_talent,"b.Rich Parents"=pref_wpart, "b.Contacts"=pref_netw)
plotlikert<-plot_likert(dat_merit, c(1,1,1,1,2,2,2,2),
groups.titles = c("Perceptions","Preferences"),
geom.colors ="PuBu",
axis.labels=c("Effort","Talent","Rich Parents","Contacts"),
catcount = 4,
cat.neutral = 3,
grid.range  =  c ( 1.2 , 1.4 ),
values  =  "sum.outside",
reverse.scale=TRUE)
plotlikert
ggsave(plotlikert,filename = "output/images/plotlikert.png",device = "png",width = 20,height = 10,dpi = "retina",units = "cm")
library(ggplot2)
library(reshape2)
library(sjPlot)
library(dplyr)
#install.packages("cowplot")
library(cowplot)
dat_merit <- dat04 %>% select("a.Effort"=perc_effort,"a.Talent"=perc_talent, "a.Rich Parents"=perc_wpart, "a.Contacts"=perc_netw, "b.Effort"=pref_effort,"b.Talent"=pref_talent,"b.Rich Parents"=pref_wpart, "b.Contacts"=pref_netw)
plotlikert<-plot_likert(dat_merit, c(1,1,1,1,2,2,2,2),
groups.titles = c("Perceptions","Preferences"),
geom.colors ="PuBu",
axis.labels=c("Effort","Talent","Rich Parents","Contacts"),
catcount = 4,
cat.neutral = 3,
grid.range  =  c ( 1.2 , 1.4 ),
values  =  "sum.outside",
reverse.scale=TRUE)
plotlikert
ggsave(plotlikert,filename = "output/images/plotlikert.png",device = "png",width = 20,height = 10,dpi = "retina",units = "cm")
rmarkdown::render_site("docs/paper.Rmd", output_format = "pdf_document")
plotlikert<-plot_likert(dat_merit, c(1,1,1,1,2,2,2,2),
groups.titles = c("Perceptions","Preferences"),
geom.colors ="PuBu",
geom.size = 0.6,
axis.labels=c("Effort","Talent","Rich Parents","Contacts"),
catcount = 4,
cat.neutral = 3,
grid.range  =  c ( 1.2 , 1.4 ),
values  =  "sum.outside",
reverse.scale=TRUE)
plotlikert<-plot_likert(dat_merit, c(1,1,1,1,2,2,2,2),
groups.titles = c("Perceptions","Preferences"),
geom.colors ="PuBu",
geom.size = 1,
axis.labels=c("Effort","Talent","Rich Parents","Contacts"),
catcount = 4,
cat.neutral = 3,
grid.range  =  c ( 1.2 , 1.4 ),
values  =  "sum.outside",
reverse.scale=TRUE)
plotlikert<-plot_likert(dat_merit, c(1,1,1,1,2,2,2,2),
groups.titles = c("Perceptions","Preferences"),
geom.colors ="PuBu",
geom.size = 1,
axis.labels=c("Effort","Talent","Rich Parents","Contacts"),
catcount = 4,
cat.neutral = 3,
grid.range  =  c ( 1.2 , 1.4 ),
values  =  "sum.outside",
reverse.scale=TRUE)
plotlikert<-plot_likert(dat_merit, c(1,1,1,1,2,2,2,2),
groups.titles = c("Perceptions","Preferences"),
geom.colors ="PuBu",
geom.size = 0.6,
axis.labels=c("Effort","Talent","Rich Parents","Contacts"),
catcount = 4,
cat.neutral = 3,
grid.range  =  c ( 1.2 , 1.4 ),
values  =  "sum.outside",
reverse.scale=TRUE)
plotlikert
plotlikert<-plot_likert(dat_merit, c(1,1,1,1,2,2,2,2),
groups.titles = c("Perceptions","Preferences"),
geom.colors ="PuBu",
geom.size = 1,
axis.labels=c("Effort","Talent","Rich Parents","Contacts"),
catcount = 4,
cat.neutral = 3,
grid.range  =  c ( 1.2 , 1.4 ),
values  =  "sum.outside",
reverse.scale=TRUE)
plotlikert
plotlikert<-plot_likert(dat_merit, c(1,1,1,1,2,2,2,2),
groups.titles = c("Perceptions","Preferences"),
geom.colors ="PuBu",
geom.size = 0.8,
axis.labels=c("Effort","Talent","Rich Parents","Contacts"),
catcount = 4,
cat.neutral = 3,
grid.range  =  c ( 1.2 , 1.4 ),
values  =  "sum.outside",
reverse.scale=TRUE)
plotlikert
library(ggplot2)
library(reshape2)
library(sjPlot)
library(dplyr)
#install.packages("cowplot")
library(cowplot)
dat_merit <- dat04 %>% select("a.Effort"=perc_effort,"a.Talent"=perc_talent, "a.Rich Parents"=perc_wpart, "a.Contacts"=perc_netw, "b.Effort"=pref_effort,"b.Talent"=pref_talent,"b.Rich Parents"=pref_wpart, "b.Contacts"=pref_netw)
plotlikert<-plot_likert(dat_merit, c(1,1,1,1,2,2,2,2),
groups.titles = c("Perceptions","Preferences"),
geom.colors ="PuBu",
geom.size = 0.8,
axis.labels=c("Effort","Talent","Rich Parents","Contacts"),
catcount = 4,
cat.neutral = 3,
grid.range  =  c ( 1.2 , 1.4 ),
values  =  "sum.outside",
reverse.scale=TRUE)
plotlikert
ggsave(plotlikert,filename = "output/images/plotlikert.png",device = "png",width = 15,height = 15,dpi = "retina",units = "cm")
library(ggplot2)
library(reshape2)
library(sjPlot)
library(dplyr)
#install.packages("cowplot")
library(cowplot)
dat_merit <- dat04 %>% select("a.Effort"=perc_effort,"a.Talent"=perc_talent, "a.Rich Parents"=perc_wpart, "a.Contacts"=perc_netw, "b.Effort"=pref_effort,"b.Talent"=pref_talent,"b.Rich Parents"=pref_wpart, "b.Contacts"=pref_netw)
plotlikert<-plot_likert(dat_merit, c(1,1,1,1,2,2,2,2),
groups.titles = c("Perceptions","Preferences"),
geom.colors ="PuBu",
geom.size = 0.8,
axis.labels=c("Effort","Talent","Rich Parents","Contacts"),
catcount = 4,
cat.neutral = 3,
grid.range  =  c ( 1.2 , 1.4 ),
values  =  "sum.outside",
reverse.scale=TRUE)
plotlikert
ggsave(plotlikert,filename = "output/images/plotlikert.png",device = "png",width = 18,height = 15,dpi = "retina",units = "cm")
rmarkdown::render_site("docs/paper.Rmd", output_format = "pdf_document")
rmarkdown::render_site("docs/paper.Rmd", output_format = "pdf_document")
rmarkdown::render_site("docs/paper.Rmd", output_format = "pdf_document")
rmarkdown::render_site("docs/paper.Rmd", output_format = "pdf_document")
source('C:/Users/Anais/Downloads/merit-scale-Final10/render-site.R', echo=TRUE)
source('C:/Users/Anais/Downloads/merit-scale-Final10/render-site.R', echo=TRUE)
source('C:/Users/Anais/Downloads/merit-scale-Final10/render-site.R', echo=TRUE)
source('C:/Users/Anais/Downloads/merit-scale-Final10/render-site.R', echo=TRUE)
source('C:/Users/Anais/Downloads/merit-scale-Final10/render-site.R', echo=TRUE)
